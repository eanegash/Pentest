#!/usr/bin/python

import scapy.all as scapy

# Using Address Resolution Protocol to build a network scanner.
# Create an ARP request directed to broadcast MAC asking for IP.
#	Use ARP to ask who has target IP.
#	Set destination MAC to broadcast MAC.
def scan(ip):
	#ARP request for a specific IP.Where pdst is the 'Target Protocol Address'
	arp_request = scapy.ARP(pdst=ip)

	# Instance of the  Scapy Ethernet object.
	broadcast = scapy.Ether(dst="ff:ff:ff:ff:ff:ff")
	
	arp_request_broadcast = broadcast/arp_request
	arp_request_broadcast.show()
	
	# Send packet, receive (capture) response, wait for 1 sec. then timeout. 
	answered_list, unanswered_list = scapy.srp(arp_request_broadcast, timeout=1)

	#Parse the response.


scan("10.0.2.1/24 ")
