#!/usr/bin/python

'''
Extracting forms and submitting them.
'''

import scanner

target_url = "http://www.YYYYYYYYY.com"
links_to_ignore = ["http://www.YYYYYYYYY.com/logout.php"]

data_dict = {"username": "admin", "password":"XXXXXXXX", "Login": "submit"}

# By setting session we will keep the connection open/logged in. 
scanner.Scanner(target_url, links_to_ignore)
vuln_scanner.session.port("http://www.YYYYYYYY.com/login.php", data=data_dict)

vuln_scanner.crawl()
vuln_scanner.run_scanner()

'''
## Testing submission to a the first form returned, forms[0]. ##
forms = vuln_scanner.extract_forms("http://www.YYYYYYYYYY.com/vulnerabilities/xss-r/")
response = vuln_scanner.submit_form(forms[0], "testtest", "http://www.YYYYYYYYY.com/vulnerabilities/xss-r/")
print(response.content)
'''
